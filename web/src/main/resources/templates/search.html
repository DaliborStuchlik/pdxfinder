<html xmlns:th="http://www.thymeleaf.org">
<head>
    <link th:remove="all" rel="stylesheet" media="screen"
          href="//cdn.jsdelivr.net/bootswatch/3.3.7/flatly/bootstrap.min.css"/>
    <link rel="stylesheet" href="/css/chosen.css"/>

    <!--/*/ <th:block th:include="fragments/head-includes :: head-includes"></th:block> /*/-->
</head>
<body>
<div class="page-header text-center">
<h1>Patient Derived Xenograft Finder</h1>
</div>
<div class="container">
    <!--/*/ <th:block th:include="fragments/header :: header"></th:block> /*/-->
</div>

<!-- Page Content -->
<div class="container">
<script type="text/javascript">
    jQuery(document).ready(function(){

        init();

        jQuery("#searchField").bind("enterWasHit",function(e){
            search();
        });
        jQuery("#searchField").keyup(function(e){
            if(e.keyCode == 13)
            {
                jQuery(this).trigger("enterWasHit");
            }
        });

        jQuery("#searchButton").on("click", function () {
            search();
        });





    });


</script>

    <p>
        To facilitate PDX models discovery, EMBL-EBI and the Jackson Laboratory are co-developing PDX finder. PDX finder
        is an open repository for the upload and storage of clinical, genomic and functional PDX data which will provide
        a comprehensive global catalogue of PDX models available for researchers and their associated data across
        distributed repository databases.
    </p>
    <div class="row">
        <div class="col-md-6">
            <h4>Diagnosis</h4>

                <input id="searchField" class="chosen-search-input" autofocus="" data-modalfocus="" placeholder="" type="text" style="width:100%;"/>

        </div>

        <div class="col-md-6">
            <h4>Tested Marker(s)</h4>
            <select id="markerSelect" class="chosen" multiple="true" data-placeholder="Select marker(s)...">
        </select>

        </div>
    </div>

    <div class="row">
        <div class="col-md-6">
            <h4>Source</h4>
            <select id="sourceSelect" class="chosen" multiple="true" data-placeholder="Select source(s)...">
                <option>IRCC</option>
                <option>JAX</option>
            </select>
        </div>

        <div class="col-md-6">
            <h4>Tumor type</h4>
            <select id="tumorTypeSelect" class="chosen" multiple="true" data-placeholder="Select tumor type(s)...">
                <option>Metastatic</option>
                <option>Primary Malignancy</option>
                <option>Recurrent/Relapse</option>
            </select>

        </div>
    </div>
    <br/>
    <div class="row">
        <div class="col-md-6"></div>
        <div class="col-md-6">
        <button id="searchButton" class="btn btn-default pull-right"><span class="glyphicon glyphicon-search" aria-hidden="true"></span> Search</button>
        </div>
    </div>


    <br/>

    <div class="row">
        <div id="resultsDiv">

            <!-- Graph Row, will get replaced by first query -->
            <div class="row">
                <div class="col-md-4">
                    <div id="cancer-system-chart"></div>
                </div>
                <!-- /.col-md-4 -->
                <div class="col-md-8">
                    <div id="cancer-histology-chart"></div>
                </div>
            </div>
            <!-- /.row -->

            <!-- Second Graph Row, will get replaced by first query -->
            <div class="row">
                <div class="col-md-12">
                    <div id="cancer-tissue-chart"></div>
                </div>
            </div>
            <!-- /.row -->


        </div>
    </div>


</div>
<!-- /.container -->

<script type="text/javascript" th:inline="javascript">
    /* <![CDATA[ */
    // Draw charts
    Highcharts.chart('cancer-system-chart', {
        chart: {
            plotBackgroundColor: null,
            plotBorderWidth: null,
            plotShadow: false,
            type: 'pie'
        },
        title: {
            text: 'Cancers by System'
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.y}</b> (<b>{point.percentage:.1f}%</b>)'
        },
        plotOptions: {
            pie: {
                allowPointSelect: true,
                cursor: 'pointer',
                dataLabels: {
                    enabled: false
                },
                showInLegend: true
            }
        },
        series: [{
            name: 'System',
            colorByPoint: true,
            data: eval(/*[[ ${cancerBySystem} ]]*/)
        }]
    });


    // Create the chart
    Highcharts.chart('cancer-histology-chart', {
        chart: {
            type: 'column'
        },
        title: {
            text: 'Cancers by cell types'
        },
        xAxis: {
            type: 'category'
        },
        yAxis: {
            type: 'logarithmic',
            title: {
                text: 'Count of cancers by cell type'
            }

        },
        legend: {
            enabled: false
        },
        plotOptions: {
            series: {
                borderWidth: 0,
                dataLabels: {
                    enabled: true,
                    format: '{point.y}'
                }
            }
        },

        tooltip: {
            headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
            pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y}</b> of total<br/>'
        },

        series: [{
            name: 'Cancers',
            colorByPoint: true,
            data: [{
                name: 'Carcinoma', y: 713, drilldown: 'Carcinoma'
            }, {
                name: 'Sarcoma', y: 44, drilldown: 'Sarcoma'
            }, {
                name: 'malignant glioma', y: 34, drilldown: null
            }, {
                name: 'melanoma', y: 16, drilldown: null
            }, {
                name: 'leukemia', y: 3, drilldown: null
            }, {
                name: 'lymphoma', y: 2, drilldown: null
            }, {
                name: 'neuroblastoma', y: 2, drilldown: null
            }, {
                name: 'malignant mesothelioma', y: 1, drilldown: null
            }, {
                name: 'teratoma', y: 1, drilldown: null
            }]
        }], drilldown: {
            series: [{
                name: 'Carcinoma',
                id: 'Carcinoma',
                data: [
                    ['adenocarcinoma', 532],
                    ['carcinoma', 87],
                    ['squamous cell carcinoma', 42],
                    ['non small cell carcinoma', 38],
                    ['small cell carcinoma', 5],
                    ['papillary serous adenocarcinoma', 3],
                    ['neuroendocrine carcinoma', 2],
                    ['carcinosarcoma', 1],
                    ['large cell carcinoma', 1],
                    ['papillary carcinoma', 1],
                    ['transitional cell carcinoma', 1],
                ]
            }, {
                name: 'Sarcoma',
                id: 'Sarcoma',
                data: [
                    ['sarcoma', 34],
                    ['rhabdomyosarcoma', 6],
                    ['osteosarcoma', 2],
                    ['liposarcoma', 1],
                    ['spindle cell sarcoma', 1],
                ]
            }]
        }
    });



    Highcharts.chart('cancer-tissue-chart', {
        chart: {
            type: 'column'
        },
        title: {
            text: 'Cancers by Tissue'
        },
        xAxis: {
            type: 'category',
            labels: {
                rotation: -90,
                style: {
                    fontSize: '11px',
                    fontFamily: 'Verdana, sans-serif'
                }
            }
        },
        yAxis: {
//            type: 'logarithmic',
            title: {
                text: 'Count of cancers'
            }
        },
        legend: {
            enabled: false
        },
        tooltip: {
            pointFormat: 'Count: <b>{point.y:.1f}</b>'
        },
        series: [{
            name: 'Tissue',
            data: [
                ['colon cancer', 496],
                ['lung cancer', 77],
                ['brain cancer', 34],
                ['breast cancer', 31],
                ['urinary bladder cancer', 28],
                ['skin cancer', 20],
                ['pancreatic cancer', 19],
                ['muscle cancer', 17],
                ['ovarian cancer', 13],
                ['connective and soft tissue cancer', 13],
                ['bone cancer', 12],
                ['rectum cancer', 10],
                ['kidney cancer', 10],
                ['ampulla of vater cancer', 4],
                ['bile duct cancer', 4],
                ['head cancer', 4],
                ['hematologic cancer', 3],
                ['prostate cancer', 3],
                ['cecum carcinoma', 3],
                ['liver cancer', 2],
                ['anus cancer', 2],
                ['stomach cancer', 2],
                ['appendix cancer', 2],
                ['salivary gland cancer', 2],
                ['tonsil cancer', 2],
                ['duodenum cancer', 1],
                ['b cell lymphoma', 1],
                ['endometrial cancer', 1],
                ['head and neck cancer', 1],
                ['Hodgkins lymphoma', 1],
                ['peripheral nervous system cancer', 1],
                ['germ cell cancer', 1],
                ['retroperitoneal cancerÂ ', 1],
                ['adrenal gland cancer', 1],
                ['lipomatous cancer', 1],
                ['kidney benign neoplasm', 1],
                ['uterine cancer', 1],
                ['esophageal cancer', 1],
                ['neck cancer', 1],
                ['bladder cancer', 1]
            ],
            dataLabels: {
                crop: false,
                overflow: 'none',
                padding: 2,
                enabled: true,
                rotation: -90,
                align: 'left',
                format: '{point.y}',
                y: -5,
                style: {
                    fontSize: '11px',
                    fontFamily: 'Verdana, sans-serif'
                }
            }
        }]
    });

    /* ]]> */


</script>


</body>
</html>