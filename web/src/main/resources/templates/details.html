<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title th:text="${data.dataSource}+' PDX model '+${data.modelId}+ ' details - PDX Finder'"></title>
    <meta name="description" th:content="'Model details for PDX '+${data.modelId}+', produced by '+${data.dataSource}"/>
    <meta name="keywords"
          th:content="'Patient Derived Xenograft, PDX, PDX Finder, Cancer, Oncology, Life Sciences, '+${data.dataSource}"/>
    <meta name="author" content="PDX Finder"/>
    <meta name="HandheldFriendly" content="true"/>
    <meta name="MobileOptimized" content="width"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>

    <link rel="apple-touch-icon" sizes="180x180"
          href="https://ebiwd.github.io/pdx-visual-framework/images/favicons/apple-touch-icon.png?v=1">
    <link rel="icon" type="image/png" sizes="32x32"
          href="https://ebiwd.github.io/pdx-visual-framework/images/favicons/favicon-32x32.png?v=1">
    <link rel="icon" type="image/png" sizes="16x16"
          href="https://ebiwd.github.io/pdx-visual-framework/images/favicons/favicon-16x16.png?v=1">
    <link rel="manifest" href="https://ebiwd.github.io/pdx-visual-framework/images/favicons/manifest.json?v=1">
    <link rel="mask-icon" href="https://ebiwd.github.io/pdx-visual-framework/images/favicons/safari-pinned-tab.svg?v=1"
          color="#0032a0">
    <link rel="shortcut icon" href="https://ebiwd.github.io/pdx-visual-framework/images/favicons/favicon.ico?v=1">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.16/css/jquery.dataTables.min.css">
    <meta name="apple-mobile-web-app-title" content="PDX Finder">
    <meta name="application-name" content="PDX Finder">
    <meta name="msapplication-config"
          content="https://ebiwd.github.io/pdx-visual-framework/images/favicons/browserconfig.xml?v=1">
    <meta name="theme-color" content="#0032a0">

    <link rel="stylesheet" href="https://dev.ebi.emblstatic.net/web_guidelines/EBI-Icon-fonts/v1.2/fonts.css"
          type="text/css" media="all"/>

    <link rel="stylesheet"
          href="https://ebi.emblstatic.net/web_guidelines/EBI-Framework/v1.2/libraries/Choices/assets/styles/css/choices.min.css">

    <link rel="stylesheet" th:href="@{/css/app.min.css}" type="text/css" media="all"/>
    <link rel="stylesheet" th:href="@{/css/customStyles.css}" type="text/css" media="all"/>
    <link rel="stylesheet" th:href="@{/icons/foundation-icons.css}" type="text/css" media="all"/>

    <!-- end CSS-->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script th:src="@{/js/jquery.dataTables.js}"></script>
    <script th:src="@{/js/scroller.js}"></script>

    <!--/*/ <th:block th:include="fragments/shared :: header"></th:block> /*/-->

</head>

<body class="level2">

<div content="content-wrapper">
    <div id="skip-to">
        <a href="#content">Skip to main content</a>
    </div>

    <div id="content">

        <!--/*/ <th:block th:include="fragments/shared :: menu"></th:block> /*/-->

        <!-- Suggested layout containers -->
        <section id="main-content-area" role="main">

            <div class="row">
                <nav aria-label="You are here:" role="navigation">
                    <ul class="breadcrumbs columns">
                        <li><a href="/">Home</a></li>
                        <li>
                            Details
                        </li>
                        <li>
                            <span class="show-for-sr">Current: </span> <span th:text="${data.modelId}">Model ID</span>
                        </li>
                    </ul>
                </nav>
            </div>

            <!-- Three Grids Section-->
            <section>
                <div class="row">

                    <div class="columns medium-4 small-12 margin-top-30">
                        <h4 class="pdxBig"><span class="float-left border-color-black"
                                                 th:text="${data.modelId+': '+data.mappedOntology}"></span></h4>
                    </div>

                    <div class="columns medium-4 small-12 margin-top-30">
                        <h4 class="pdxBig black"><span class="float-left" th:text="${data.sourceName}"> The Jackson Laboratory </span>
                        </h4>
                    </div>

                    <div class="columns medium-4 small-12 shiftUp20">

                        <a th:href="@{'mailto:'+${data.contacts+'?subject='+data.modelId}}"
                           th:if="${ data.contacts != null && #strings.contains(data.contacts,'@')}">
                            <h4 class="button more uppercase margin-top-large minwidth300 card-3b">Contact Provider</h4>
                        </a>


                        <a th:href="@{'mailto:'+${data.externalUrl+'?subject='+data.modelId}}"
                           th:if="${data.externalUrl != null &&  #strings.contains(data.externalUrl,'@')}">
                            <h4 class="button more uppercase margin-top-large minwidth300 card-3b">Contact Provider</h4>
                        </a>

                        <a th:href="@{${data.contacts}}" th:target="_blank"
                           th:if="${data.contacts != null && #strings.contains(data.contacts,'http') }">
                            <h4 class="button more uppercase margin-top-large minwidth300 card-3b">Contact Provider</h4>
                        </a>

                        <!--<a th:href="@{${data.contacts}}" th:target="_blank"     && #strings.endsWith(data.contacts,'=')
                           th:if="${#strings.contains(data.contacts,'http') && not #strings.endsWith(data.contacts,'=')}">
                            <h4 class="button more uppercase margin-top-large minwidth300">Contact Provider</h4>
                        </a> -->

                        <a th:href="@{${data.externalUrl}}" th:target="_blank"
                           th:if="${data.externalUrl != null && #strings.contains(data.externalUrl,'http')}">
                            <h4 class="button outline uppercase margin-top-large minwidth300 shiftUp10 card-3b"
                                th:text="${data.externalUrlText}">View at Provider</h4>
                        </a>

                        <a th:href="@{'/pdx/'+${data.dataSource}+'/'+${data.modelId}+'/pdf'}"
                           th:target="_blank"
                           class="button outline uppercase margin-top-large minwidth300 shiftUp10 card-3b">
                            <span> Download PDF <i class="icon icon-functional" data-icon="="></i> </span>
                        </a>

                    </div>
                </div>
            </section>
            <hr class="margin-vertical-20 line_v2">


            <!-- Tabs Section -->
            <section class="row large-10 medium-12 expanded" id="detailsData">

                <div class="row large-12 medium-12 expanded">
                    <ul class="tabs style-2"   data-deep-link="true" data-tabs id="example2-tabs">

                        <li class="tabs-title is-active">
                            <a href="#summary" aria-selected="true" style="font-size: 15px; padding: 15px;"> PDX Model </a>
                        </li>


                        <li class="tabs-title">
                            <a href="#patients" style="font-size: 15px; padding: 15px;"> Patient </a>
                        </li>

                        <li th:if="${ #lists.isEmpty(data.dataSummary)}"
                            class="tabs-title ">
                            <a href="#variation" style="font-size: 15px; padding: 15px;" id="variation_data_link" onclick="initTabs('0')">
                                Molecular Data (0)
                            </a>
                        </li>

                        <li th:if="${ not #lists.isEmpty(data.dataSummary) }"
                            class="tabs-title ">
                            <a href="#variation" style="font-size: 15px; padding: 15px;" id="variation_data_link" onclick="initTabs('0')">
                                Molecular Data
                                (<span th:text="${data.xenograftDataSize}"> ... </span>) <!-- #lists.size(data.dataSummary) -->
                            </a>
                        </li>


                        <li th:if="${data.drugSummaryRowNumber} == 0" class="tabs-title">
                            <a href="#dosing_studies" style="font-size: 15px; padding: 15px;">Dosing study (0)</a>
                        </li>


                        <li th:if="${data.drugSummaryRowNumber} > 0" class="tabs-title">
                            <a href="#dosing_studies" style="font-size: 15px; padding: 15px;">Dosing study (1)</a>
                        </li>

                    </ul>

                </div>

                <div class="tabs-content style-2" data-tabs-content="example2-tabs">

                    <div class="tabs-panel is-active" id="summary">


                        <!-- Summary first row -->
                        <div class="row large-12 medium-12 expanded">

                            <div class="columns medium-12 small-12 margin-top-30 card-3">
                                <div class="responsive-table top-space-20">
                                    <table class="datatable-pdx table-borderedPdx pdx-table head-left">
                                        <thead>
                                        <tr>
                                            <th colspan="2"> Patient</th>
                                        </tr>
                                        </thead>
                                        <tbody>

                                        <tr>
                                            <th class="text-left medium-4">Sex</th>
                                            <td th:text="${data.gender}"></td>
                                        </tr>
                                        <tr>
                                            <th class="text-left medium-4">Age at Time of Collection</th>
                                            <td th:text="${data.ageAtCollection}"></td>
                                        </tr>
                                        <tr>
                                            <th class="text-left medium-4">Race / Ethnicity</th>
                                            <td>
                                                <span th:text="${data.race}"></span>
                                                <span th:if="${not ( #strings.isEmpty(data.race) || #strings.isEmpty(data.ethnicity) ) }"> / </span>
                                                <span th:text="${data.ethnicity}"></span>
                                            </td>
                                        </tr>
                                        <tr th:if="${not #lists.isEmpty(data.relatedModels)}">
                                            <th class="text-left">Related models</th>
                                            <td><span th:each="relMod:${data.relatedModels}"><a th:text="${relMod}"
                                                                                                th:href="@{'/pdx/'+${data.dataSource}+'/'+${relMod}}"></a> </span>
                                            </td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>

                            <div class="columns medium-12 small-12 margin-top-medium card-3">
                                <div class="responsive-table top-space-20">
                                    <table class="datatable-pdx table-borderedPdx pdx-table head-left">
                                        <thead>
                                        <tr>
                                            <th colspan="2"> Patient Tumor</th>
                                        </tr>
                                        </thead>
                                        <tbody>

                                        <tr>
                                            <th class="text-left medium-4">Histology</th>
                                            <td class="text-left"><span th:text="${data.mappedOntology}"></span></td>
                                        </tr>

                                        <tr>
                                            <th class="text-left medium-4">Primary Tissue</th>
                                            <td class="text-left" th:text="${data.originTissue}"></td>
                                        </tr>

                                        <tr>
                                            <th class="text-left medium-4">Collection Site</th>
                                            <td class="text-left" th:text="${data.sampleSite}"></td>
                                        </tr>

                                        <tr>
                                            <th class="text-left medium-4">Tumor Type</th>
                                            <td class="text-left" th:text="${data.tumorType}"></td>
                                        </tr>

                                        <tr>
                                            <th class="text-left medium-4"> Grade</th>
                                            <td th:if="${#strings.equalsIgnoreCase(data.grade, 'Not Specified') || #strings.equalsIgnoreCase(data.gradeClassification, 'Not Specified')}">
                                                <span th:utext="${data.grade}"></span>
                                            </td>
                                            <td th:if="${not ( #strings.equalsIgnoreCase(data.grade, 'Not Specified') || #strings.equalsIgnoreCase(data.gradeClassification, 'Not Specified') ) }">
                                                <span th:utext="${data.grade}"></span>
                                                <span th:utext="${'(<b> Classification: </b>'+data.gradeClassification+')'}"></span>
                                            </td>
                                        </tr>

                                        <tr>
                                            <th class="text-left medium-4"> Stage</th>
                                            <td th:if="${#strings.equalsIgnoreCase(data.stage, 'Not Specified') || #strings.equalsIgnoreCase(data.stageClassification, 'Not Specified')}">
                                                <span th:utext="${data.stage}"></span>
                                            </td>
                                            <td th:if="${not ( #strings.equalsIgnoreCase(data.stage, 'Not Specified') || #strings.equalsIgnoreCase(data.stageClassification, 'Not Specified') ) }">
                                                <span th:utext="${data.stage}"></span>
                                                <span th:utext="${'(<b> Classification: </b>'+data.stageClassification+')'}"></span>
                                            </td>
                                        </tr>

                                        </tbody>
                                    </table>
                                </div>

                            </div>


                            <!--
                            <div class="columns medium-12 small-12 margin-top-medium card-3">
                                <div class="responsive-table top-space-20">
                                    <table class="datatable-pdx table-borderedPdx pdx-table head-left">
                                        <thead>
                                        <tr>
                                            <th colspan="2">PDX model</th>
                                        </tr>
                                        </thead>
                                        <tbody>

                                        <tr>
                                            <th class="text-left medium-4">Strain</th>
                                            <td class="text-left" th:text="${data.strain}"></td>
                                        </tr>
                                        <tr>
                                            <th class="text-left medium-4">Engraftment Site</th>
                                            <td th:text="${data.engraftmentSite}"></td>
                                        </tr>
                                        <tr>
                                            <th class="text-left medium-4">Implantation Material</th>
                                            <td th:text="${data.sampleType}"></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div> -->


                            <div class="columns medium-12 small-12 margin-top-medium card-3">
                                <div class="responsive-table top-space-20">

                                    <table class="datatable-pdx pdx-table table-borderedPdx head-left">
                                        <thead>
                                        <tr>
                                            <th colspan="6">PDX model Engraftment</th>
                                        </tr>
                                        <tr>
                                            <th> Host Strain Name</th>
                                            <th>  Site</th>
                                            <th>  Type</th>
                                            <th>  Material</th>
                                            <th>  Material Status</th>
                                            <th>Passage</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr th:each="pdxModel, iter : ${data.pdxModelList}">
                                            <td th:text="${pdxModel.strainName}"></td>
                                            <td th:text="${pdxModel.engraftmentSite}" class="capt-text"></td>
                                            <td th:text="${pdxModel.engraftmentType}" class="capt-text"></td>
                                            <td th:text="${pdxModel.engraftmentMaterial}" class="capt-text"></td>
                                            <td th:text="${pdxModel.engraftmentMaterialState}" class="capt-text"></td>
                                            <td th:text="${pdxModel.passage}" class="capt-text"></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>


                            <div class="columns medium-12 small-12 margin-top-medium card-3">
                                <div class="responsive-table top-space-20">

                                    <table class="datatable-pdx pdx-table table-borderedPdx head-left">
                                        <thead>
                                        <tr>
                                            <th colspan="3">Model Quality Control</th>
                                        </tr>
                                        <tr>
                                            <th>Technique</th>
                                            <th>Description</th>
                                            <th>Passage</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr th:each="qa, iter : ${data.qualityAssurances}">
                                            <td th:text="${qa.technology}" class="capt-text"></td>
                                            <td th:text="${qa.description}" class="capt-text"></td>
                                            <td th:text="${qa.passages}" class="capt-text"></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>

                            </div>

                        </div>


                    </div>








                    <div class="tabs-panel" id="patients">

                            <!-- Tabs Section
                            <section class="row large-12 medium-12 expanded" id="detailsData">
                                <div class="row large-12 medium-12 expanded">
                                    <ul class="tabs style-2"   data-deep-link="true" data-tabs id="example2-tabs">
                                        <li class="tabs-title is-active"><a href="#initialDiagnosis" aria-selected="true" style="font-size: 15px; padding: 15px;"> Patient at Tumor Collection </a></li>
                                    </ul>
                                </div>

                                <div class="tabs-content style-2" data-tabs-content="example2-tabs">
                                    <div class="tabs-panel is-active" id="summary">

                                        <div class="row large-12 medium-12 expanded">

                                            <div class="columns medium-12 small-12 margin-top-10 card-3">
                                                <div class="responsive-table" style="margin-top: 20px;">
                                                    <table class="pdx-table head-left">
                                                        <tbody>
                                                        <tr>
                                                            <th class="text-left medium-4">Gender</th>
                                                            <td th:text="${data.patient.gender}"></td>
                                                        </tr>
                                                        <tr>
                                                            <th class="text-left medium-4"> Age at Diagnosis</th>
                                                            <td th:text="${data.patient.ageAtDiagnosis}"></td>
                                                        </tr>
                                                        <tr>
                                                            <th class="text-left medium-4">Disease Body Location</th>
                                                            <td th:text="${data.patient.diseaseBodyLocation}"></td>
                                                        </tr>
                                                        <tr>
                                                            <th class="text-left medium-4">CTEP SDC Code</th>
                                                            <td th:text="${data.patient.CTEPSDCCode}"></td>
                                                        </tr>
                                                        <tr>
                                                            <th class="text-left medium-4">Diagnosis Subtype</th>
                                                            <td th:text="${data.patient.diagnosisSubtype}"></td>
                                                        </tr>
                                                        <tr>
                                                            <th class="text-left medium-4">Race / Ethnicity</th>
                                                            <td th:text="${data.patient.raceAndEthnicity}"></td>
                                                        </tr>
                                                        <tr>
                                                            <th class="text-left medium-4">Sex</th>
                                                            <td th:text="${data.patient.gender}"></td>
                                                        </tr>
                                                        <tr>
                                                            <th class="text-left medium-4">Race / Ethnicity</th>
                                                            <td>
                                                                <span th:text="${data.race}"></span>
                                                                <span th:if="${not ( #strings.isEmpty(data.race) || #strings.isEmpty(data.ethnicity) ) }"> / </span>
                                                                <span th:text="${data.ethnicity}"></span>
                                                            </td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section> -->


                        <!--
                        <th class="text-left large-12" style="font-size: 17px;">IHC: CD34+, CD99+, EMA+, bcl2+; AE1/AE3 -, CAM5.2 - </th>
                            <section class="row large-12 medium-12 expanded" id="detailsData" style="margin-top: 20px;">
                                <div class="row large-12 medium-12 expanded">
                                    <ul class="tabs style-2"   data-deep-link="true" data-tabs id="example2-tabs">
                                        <li class="tabs-title is-active"><a href="#initialDiagnosis" aria-selected="true" style="font-size: 15px; padding: 15px;">Additional patient History</a></li>
                                    </ul>
                                </div>

                                <div class="tabs-content style-2" data-tabs-content="example2-tabs">
                                    <div class="tabs-panel is-active" id="summary">


                                        <div class="row large-12 medium-12 expanded">

                                            <div class="columns medium-12 small-12 margin-top-10 card-3">
                                                <div class="responsive-table" style="margin-top: 20px;">
                                                    <table class="datatable-pdx table-borderedPdx pdx-table head-left">
                                                        <thead>
                                                        <tr>
                                                            <th colspan="2"> Known Genetic Mutations / Tumor Markers</th>
                                                        </tr>
                                                        </thead>
                                                        <tbody>

                                                        <tr>
                                                            <td>
                                                    <span th:each="mut : ${data.patient.knownGeneticMutations}"
                                                          th:text="${mut}"> ...
                                                    </span>

                                                            </td>
                                                        </tr>
                                                        </tbody>
                                                    </table>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>-->





                            <section class="row large-12 medium-12 expanded" id="detailsData" style="margin-top: 20px;">

                                <div class="row large-12 medium-12 expanded">
                                    <ul class="tabs style-2"   data-deep-link="true" data-tabs id="example2-tabs">
                                        <li class="tabs-title is-active"><a href="#initialDiagnosis"
                                                                            aria-selected="true"
                                                                            style="font-size: 15px; padding: 15px;">
                                            Patient Tumor Collection For PDX Model </a></li>
                                    </ul>
                                </div>




                                <div class="tabs-content style-2" data-tabs-content="example2-tabs">
                                    <div class="tabs-panel is-active" id="summary">

                                        <div class="row large-12 medium-12 expanded">

                                            <div class="columns medium-12 small-12 margin-top-10 card-3">
                                                <div class="responsive-table" style="margin-top: 20px;">
                                                    <table class="pdx-table head-left">
                                                        <thead>
                                                        <th> </th>
                                                        <th:block th:if="${not #lists.isEmpty(data.patient.collectionEvents)}"
                                                                  th:each="event, iter : ${data.patient.collectionEvents}">

                                                            <th th:if="${event.pdxMouse != data.modelId}"
                                                                th:text="${'Collection '} + ${' (Other Model)'}">
                                                                Collection
                                                            </th>
                                                            <th th:if="${event.pdxMouse == data.modelId}"
                                                                th:text="${'Collection '} + ${' (Current Model)'}">
                                                                Collection
                                                            </th>

                                                        </th:block>
                                                        </thead>
                                                        <tbody>

                                                        <th:block th:if="${not #lists.isEmpty(data.patient.collectionEvents)}">

                                                            <tr>
                                                                <th class="text-left medium-4">Age</th>

                                                                <th:block th:each="event : ${data.patient.collectionEvents}">
                                                                    <td th:text="${event.age}"
                                                                        th:class="${#strings.equals(event.pdxMouse, data.modelId) } ? 'highlight-bg' : 'table-focus' ">
                                                                        ... AGE ...
                                                                    </td>
                                                                </th:block>
                                                            </tr>

                                                            <tr>
                                                                <th class="text-left medium-4"> Diagnosis</th>

                                                                <th:block th:each="event : ${data.patient.collectionEvents}">
                                                                    <td th:text="${event.diagnosis}"
                                                                        th:class="${#strings.equals(event.pdxMouse, data.modelId) } ? 'highlight-bg' : 'table-focus' ">
                                                                        ... DIAGNOSIS ...
                                                                    </td>
                                                                </th:block>
                                                            </tr>

                                                            <tr>
                                                                <th class="text-left medium-4"> Type </th>

                                                                <th:block th:each="event : ${data.patient.collectionEvents}">
                                                                    <td th:text="${event.type}"
                                                                        th:class="${#strings.equals(event.pdxMouse, data.modelId) } ? 'highlight-bg' : 'table-focus' ">
                                                                        ... TYPE ...
                                                                    </td>
                                                                </th:block>
                                                            </tr>

                                                            <tr>
                                                                <th class="text-left medium0-4"> PDX Mouse</th>
                                                                <th:block th:each="event : ${data.patient.collectionEvents}">

                                                                    <td th:class="${#strings.equals(event.pdxMouse, data.modelId) } ? 'highlight-bg' : 'table-focus' ">

                                                                        <span th:if="${#strings.equals(event.pdxMouse, data.modelId) }" th:text="${event.pdxMouse}">
                                                                         ... MODELID ...
                                                                        </span>

                                                                        <span th:if="${not #strings.equals(event.pdxMouse, data.modelId) }">
                                                                            <a th:text="${event.pdxMouse}"
                                                                               th:href="@{'/pdx/'+${data.dataSource}+'/'+${event.pdxMouse}}" target="_blank"> ... MODELID ... </a>
                                                                        </span>
                                                                    </td>

                                                                </th:block>
                                                            </tr>

                                                            <tr>
                                                                <th class="text-left medium-4">Collection Site</th>

                                                                <th:block th:each="event : ${data.patient.collectionEvents}">
                                                                    <td th:text="${event.collectionSite}"
                                                                        th:class="${#strings.equals(event.pdxMouse, data.modelId) } ? 'highlight-bg' : 'table-focus' ">
                                                                        ... COLLECTION SITE ...
                                                                    </td>
                                                                </th:block>
                                                            </tr>

                                                            <!--<tr>
                                                            <th class="text-left medium-4">Data</th>

                                                            <th:block th:each="event : ${data.patient.collectionEvents}">
                                                                <td th:text="${event.data}"
                                                                    th:class="${#strings.equals(event.pdxMouse, data.modelId) } ? 'highlight-bg' : 'table-focus' ">
                                                                    ... DATASET ...
                                                                </td>
                                                            </th:block>
                                                            </tr> -->


                                                        </th:block>

                                                        </tbody>
                                                    </table>

                                                    <table class="pdx-table head-left"  >
                                                        <tbody>
                                                        <tr>
                                                            <th class="text-left medium-4">Sex</th>
                                                            <td th:text="${data.patient.gender}"></td>
                                                        </tr>
                                                        <tr>
                                                            <th class="text-left medium-4">Race / Ethnicity</th>
                                                            <td>
                                                                <span th:text="${data.race}"></span>
                                                                <span th:if="${not ( #strings.isEmpty(data.race) || #strings.isEmpty(data.ethnicity) ) }"> / </span>
                                                                <span th:text="${data.ethnicity}"></span>
                                                            </td>
                                                        </tr>
                                                        </tbody>
                                                    </table>

                                                </div>



                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>


                        <!-- Disable Current Treatment Table
                        <section class="row large-12 medium-12 expanded"
                                 id="detailsData"
                                 style="margin-top: 20px;"
                                 th:if="${ #bools.isTrue(data.patient.currentTreatmentExists) } ">

                            <div class="row large-12 medium-12 expanded">
                                    <ul class="tabs style-2"   data-deep-link="true" data-tabs id="example2-tabs">
                                        <li class="tabs-title is-active"><a href="#initialDiagnosis" aria-selected="true" style="font-size: 15px; padding: 15px;"> Current Therapy </a></li>
                                    </ul>
                            </div>

                                <div class="tabs-content style-2" data-tabs-content="example2-tabs">
                                    <div class="tabs-panel is-active" id="summary">

                                        <div class="row large-12 medium-12 expanded">

                                            <div class="columns medium-12 small-12 margin-top-10 card-3">
                                                <div class="responsive-table" style="margin-top: 20px;">
                                                    <table class="pdx-table head-left">
                                                        <thead>
                                                        <th> Date Regimen Started </th>
                                                        <th> Regimen </th>
                                                        <th> Dose </th>
                                                        <th> Best Response </th>
                                                        <th> Duration (Months) </th>
                                                        </thead>
                                                        <tbody>


                                                        <th:block th:if="${not #lists.isEmpty(data.patient.treatmentSummaries)}"
                                                                  th:each="treatment : ${data.patient.treatmentSummaries}">

                                                            <tr  th:if="${ #bools.isTrue(treatment.current) } ">

                                                                <th class="text-left medium-4"
                                                                    th:text="${treatment.treatmentDate+' (Current)'}"> ...DATE... </th>

                                                                <td th:text="${treatment.drugNames}"></td>
                                                                <td th:text="${treatment.dose}">  </td>


                                                                <td th:text="${treatment.response}">  </td>
                                                                <td th:text="${treatment.duration}"> </td>

                                                            </tr>

                                                        </th:block>

                                                        </tbody>
                                                    </table>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                        </section> -->


                        <section class="row large-12 medium-12 expanded"
                                 id="detailsData"
                                 style="margin-top: 20px;"
                                 th:if="${ #bools.isTrue(data.patient.treatmentExists) } ">

                            <div class="row large-12 medium-12 expanded">
                                    <ul class="tabs style-2"   data-deep-link="true" data-tabs id="example2-tabs">
                                        <li class="tabs-title is-active"><a href="#initialDiagnosis"
                                                                            aria-selected="true"
                                                                            style="font-size: 15px; padding: 15px;">
                                            Patient Therapies & Response </a></li>
                                    </ul>
                                </div>

                                <div class="tabs-content style-2" data-tabs-content="example2-tabs">
                                    <div class="tabs-panel is-active" id="summary">

                                        <!-- Summary first row -->
                                        <div class="row large-12 medium-12 expanded">

                                            <div class="columns medium-12 small-12 margin-top-10 card-3">
                                                <div class="responsive-table" style="margin-top: 20px;">
                                                    <table class="pdx-table head-left">
                                                        <thead>
                                                        <th> Date Regimen Started </th>
                                                        <th> Regimen </th>
                                                        <th> Dose </th>
                                                        <th> Best Response </th>
                                                        <th> Duration (Months)</th>
                                                        </thead>
                                                        <tbody>


                                                        <th:block th:if="${not #lists.isEmpty(data.patient.treatmentSummaries)}"
                                                                  th:each="treatment : ${data.patient.treatmentSummaries}">

                                                            <tr  th:if="${ #bools.isFalse(treatment.current) } ">

                                                                <th class="text-left medium-4 capt-text"
                                                                    th:text="${treatment.treatmentDate}"> ...DATE... </th>

                                                                <td th:text="${treatment.drugNames}"></td>
                                                                <td th:text="${treatment.dose}">  </td>
                                                                <td th:text="${treatment.response}">  </td>
                                                                <td th:text="${treatment.duration}"> </td>

                                                            </tr>

                                                        </th:block>


                                                        <th:block
                                                                th:if="${not #lists.isEmpty(data.patient.treatmentSummaries)}"
                                                                th:each="treatment : ${data.patient.treatmentSummaries}">

                                                            <tr th:if="${ #bools.isTrue(treatment.current) } ">

                                                                <th class="text-left medium-4"
                                                                    th:text="${treatment.treatmentDate+' (Current)'}">
                                                                    ...DATE...
                                                                </th>

                                                                <td th:text="${treatment.drugNames}"></td>
                                                                <td th:text="${treatment.dose}"></td>


                                                                <td th:text="${treatment.response}"></td>
                                                                <td th:text="${treatment.duration}"></td>

                                                            </tr>

                                                        </th:block>

                                                        </tbody>
                                                    </table>
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>
                        

                    </div>





                    <div class="tabs-panel is-active" id="variation">


                        <div class="row large-12 medium-12 expanded" id="variationTableData">

                            <!-- Start of Patient variation data
                            <div class="tab" role="tabpanel" th:if="${data.patientTech.size() > 0}">

                                <ul class="nav nav-tabs" role="tablist">
                                    <li th:each="technology,iter : ${data.patientTech}"
                                        th:class="( ${iter.index} == 0 ) ? 'active' : '' "
                                        role="presentation">

                                        <a th:href="@{'#'+${technology.key}}"
                                           th:text="${technology.key}+' Platform'" role="tab" data-toggle="tab"
                                           th:onclick="'showTabs('+${iter.index}+')'"> TAB TITLES </a>

                                    </li>
                                </ul>




                                <div class="tab-content">
                                    <div th:each="technology,iter : ${data.patientTech}"
                                         th:id="${technology.key}"
                                         class="tab-pane active" role="tabpanel">


                                                <span>
                                                        <div class="table-responsive" th:classappend="( ${iter.index} == 0 ) ? 'hideContent' : 'hideContent' ">

                                                            <b class="bLine">
                                                                <span class="hdc">Tumor Type: </span>            <i>Patient Tumor</i>                  &nbsp; &nbsp;
                                                                <span class="hdc">Histology:</span> <i
                                                                    th:text="${#strings.capitalize(data.diagnosis)}"></i>     &nbsp; &nbsp;
                                                                <span class="hdc">Grade: </span>  <i></i>
                                                            </b>

                                                            <table id="pdxFinder-grid"
                                                                   class="unstriped pdx-table">

                                                                <thead>
                                                                <tr>
                                                                    <th>Sample </th>
                                                                    <th>Platform(s)</th>
                                                                    <th>Chromosome</th>
                                                                    <th>Seq. Position</th>
                                                                    <th>Ref. Allele</th>
                                                                    <th>Alt. Allele</th>
                                                                    <th>Consequence</th>
                                                                    <th>Gene</th>
                                                                    <th>Amino Acid Change</th>
                                                                    <th>Read Depth</th>
                                                                    <th>Allele Freq.</th>
                                                                    <th>RS Variants</th>
                                                                </tr>
                                                                </thead>
                                                            </table>
                                                        </div>

                                                </span>

                                    </div>
                                </div>

                            </div>
                            End of Patient Variation Data -->


                            <!-- Start of Xenograft Variation data-->
                            <div class="tab hideContent0" role="tabpanel" th:if="${data.modelTechAndPassages.size() > 0}">

                                <div  th:if="${not #lists.isEmpty(data.dataSummary)}" class="row large-12 medium-12 expanded">

                                    <div class="columns medium-12 small-12 margin-top-10 card-3">
                                        <div class="responsive-table" style="margin-top: 20px;">

                                                <table class="datatable-pdx pdx-table table-borderedPdx head-left" data-tabs id="example-tabs">
                                                    <thead>
                                                    <th>Sample ID</th>
                                                    <th>Sample Type</th>
                                                    <th>Engrafted Tumor Passage</th>
                                                    <th>Data Available</th>
                                                    <th>Platform Used</th>
                                                    <th>Raw Data</th>
                                                    </thead>
                                                    <tbody>


                                                    <tr th:each="dataSummary,iter : ${data.dataSummary}"
                                                        class="tabs-title" style="float:none; text-transform: capitalize;" th:classappend="( ${iter.index} == 0 ) ? 'is-active' : '' ">

                                                        <td th:text="${dataSummary.sampleId}"> ... </td>
                                                        <td th:text="${dataSummary.sampleType}"> ... </td>
                                                        <td th:text="${'Passage '+dataSummary.xenograftPassage}"> ... </td>


                                                        <td>
                                                            <a th:href="@{'#'+${dataSummary.platformUsed}}"
                                                               style="color: #06369d; text-decoration: none;"
                                                               data-th-attr="data-tabs-target=${dataSummary.platformUsed},  aria-selected=( ${iter.index} == 0 ) ? 'true' : '' "
                                                               th:text="${dataSummary.platformUsed}+' Platform'"
                                                               th:onclick="'showTabs('+${iter.index}+')'">
                                                                TAB TITLES
                                                            </a>
                                                        </td>
                                                        <td>
                                                            <a target="_blank"
                                                               style="color: #06369d; text-decoration: none;"
                                                               th:text="${dataSummary.platformUsed}"
                                                               th:onclick="'window.open(\''+${data.platformsAndUrls[dataSummary.platformUsed]}+'\')'">
                                                                ...
                                                            </a>
                                                        </td>
                                                        <td th:text="${dataSummary.rawData}"></td>
                                                    </tr>

                                                    </tbody>
                                                </table>

                                            </div>
                                        </div>

                                    </div>



                                <div class="hideVariationData">
                                    <div class="row large-12 medium-12 expanded top-space-30 ">
                                        <ul class="tabs style-2"   data-deep-link="true" data-tabs id="example2-tabs">
                                            <li class="tabs-title is-active">
                                                <a href="#initialDiagnosis"
                                                   aria-selected="true"
                                                   style="font-size: 15px; padding: 15px;">
                                                    Genomic Data (<span th:text="${data.variationDataCount}"></span>)
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="columns medium-12 small-12 card-3" style="padding: 15px;">

                                        <div id="sizeSwitch" style="float: right; margin-top:-65px;">
                                            <a th:href="@{'/pdx/'+${data.dataSource}+'/'+${data.modelId}+'/export'}"
                                               class="button outline secondary">
                                                Download Results
                                                <i class="icon icon-functional" data-icon="="></i>
                                            </a>
                                        </div>

                                        <div class="tabs-content" data-tabs-content="example-tabs">

                                            <!--<ul class="tabs rem-side-borders" data-tabs id="example-tabs">
                                                <li th:each="technology,iter : ${data.modelTechAndPassages}"
                                                    class="tabs-title" th:classappend="( ${iter.index} == 0 ) ? 'is-active' : '' ">

                                                    <a th:href="@{'#'+${technology.key}}"
                                                       data-th-attr="data-tabs-target=${technology.key},  aria-selected=( ${iter.index} == 0 ) ? 'true' : '' "
                                                       th:text="${technology.key}+' Platform'" th:onclick="'showTabs('+${iter.index}+')'">
                                                        TAB TITLES
                                                    </a>
                                                </li>
                                            </ul>-->

                                            <div th:each="technology,iter : ${data.modelTechAndPassages}"
                                                 th:id="${technology.key}"
                                                 class="tabs-panel is-active"
                                                 th:classappend=" 'hideContent'+${iter.index} " style="border-top: 1px solid #5ea88f; margin-top:20px;">

                                                <hr class="hr-text" th:attr="data-content=${technology.key+' PLATFORM '}">

                                                        <span th:unless="${technology.value.size()<1}"
                                                              th:each="num: ${#numbers.sequence(1,technology.value.size())}"> <!--/* Unable to capture index for inner loop so, this was used for innerloop : <tr th:each="passageList : ${technolog[y.value]}"> */-->



                                                                <div class="table-responsive">

                                                                    <h4 class="bLine"
                                                                        th:classappend="( ${num} == 1 ) ? '' : 'topSpace50' ">

                                                                        <span class="hdc">Sample ID: </span>

                                                                        <b class="black"
                                                                           th:text="${data.techNPassToSampleId['__${technology.key}__'+'__${technology.value[num-1]}__']}"></b>    &nbsp; &nbsp;

                                                                        <span class="hdc">Histology:</span> <b class="black"
                                                                                                               th:text="${#strings.capitalize(data.diagnosis)}"></b>     &nbsp; &nbsp;
                                                                        <span class="hdc">Tumor Type: </span>
                                                                        <b class="black">Engrafted Tumor</b>                  &nbsp; &nbsp;
                                                                        <span class="hdc">Passage: </span>  <b class="black"
                                                                                                               th:text="${technology.value[num-1]}"></b>     &nbsp; &nbsp;
                                                                        <span class="hdc">Platform: </span>

                                                                        <span th:if="${data.platformsAndUrls.containsKey(technology.key)}">
                                                                                <a th:href="${data.platformsAndUrls[technology.key]}" th:text="${technology.key}"></a>
                                                                            </span>

                                                                        <span th:if="${not data.platformsAndUrls.containsKey(technology.key)}">
                                                                                <b class="black" th:text="${technology.key}"></b>
                                                                        </span>

                                                                    </h4>

                                                                    <table th:id="'pdxFinder-grid'+${#strings.replace(technology.key,' ','-')}+${num}"
                                                                           id="example-datatable"
                                                                           class="table display datatable-pdx table-borderedPdx"
                                                                           th:height="50" width="100%">

                                                                        <thead>
                                                                        <tr>
                                                                            <th>Sample </th>
                                                                            <th>Chromosome</th>
                                                                            <th>Seq. Position</th>
                                                                            <th>Ref. Allele</th>
                                                                            <th>Alt. Allele</th>
                                                                            <th>Consequence</th>
                                                                            <th>Gene</th>
                                                                            <th>Amino Acid Change</th>
                                                                            <th>Read Depth</th>
                                                                            <th>Allele Freq.</th>
                                                                            <th>RS Variants</th>
                                                                        </tr>
                                                                        </thead>
                                                                    </table>
                                                                </div>

                                                        </span>

                                            </div>
                                        </div>
                                    </div>
                                </div>

                                </div>
                                <!-- End of Xenograft Variation data -->

                            </div>

                        </div>

                        <div class="tabs-panel" id="dosing_studies">
                            <div th:if="${not #lists.isEmpty(data.drugSummary)}">

                                <div class="columns medium-12 small-12 margin-top-10 card-3">
                                    <div class="responsive-table" style="margin-top: 20px;">

                                        <div th:if="${data.drugProtocolUrl} != null" class="drug_spacing">
                                            <a th:href="${data.drugProtocolUrl}" >Dosing study protocol</a>
                                        </div>

                                        <table class="datatable-pdx pdx-table table-borderedPdx head-left">
                                            <thead>
                                            <th>Drug</th>
                                            <th>Dose</th>
                                            <th>Response</th>
                                            </thead>
                                            <tbody>
                                            <tr th:each="drugData, iter : ${data.drugSummary}">
                                                <td th:text="${drugData.drugName}"></td>
                                                <td th:text="${drugData.dose}"></td>
                                                <td th:text="${drugData.response}"></td>
                                            </tr>
                                            </tbody>
                                        </table>

                                    </div>
                                </div>

                            </div>

                            <div th:if="${#lists.isEmpty(data.drugSummary)}"></div>
                        </div>

                    </div>


            </section>


        </section>

    </div>
    <!-- End suggested layout containers / #content -->


    <!--/*/ <th:block th:include="fragments/shared :: footer"></th:block> /*/-->


</div>
<!-- JavaScript -->

<script  type='text/javascript' th:src="@{/js/banner-gdpr.js}"></script>
<div id="data-protection-message-configuration"
     data-message="Your message and links here."
     data-service-id="ebi" data-data-protection-version="0.1">
</div>

<script src="https://ebi.emblstatic.net/web_guidelines/EBI-Framework/v1.2/libraries/Choices/assets/scripts/dist/choices.min.js"></script>
<script src="https://ebi.emblstatic.net/web_guidelines/EBI-Framework/v1.3/libraries/foundation-6/js/foundation.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jQuery.highlightRegex/0.1.2/highlightRegex.min.js"></script>
<script th:src="@{/js/script.js}"></script>
<!--<script th:src="@{/js/main.js}"></script>-->


<script type="text/javascript" language="javascript" th:inline="javascript">

    var modelId = [[${data.modelId}]];
    var dataSrc = [[${data.dataSource}]];
    jQuery(document).ready(function () {
        console.log("ready");
        var modelInfo = [[${data.modelTechAndPassages}]];
        var apiURL = "/data/patientdata/" + dataSrc + "/" + modelId;


        drawTable("pdxFinder-grid", apiURL);
        for (var tech in modelInfo) {
            //console.log(tech);

            var counter = 1;
            for (var passage in modelInfo[tech]) {
                //console.log(modelInfo[tech][passage]);
                var dTech = tech.replace(" ", "-");
                //console.log(dTech);
                apiURL = "/data/modeldata/" + dataSrc + "/" + modelId + "?platform=" + tech + "&passage=" + modelInfo[tech][passage];
                var tableId = "pdxFinder-grid" + dTech + counter;
                drawTable(tableId, apiURL);
                //console.log(tableId);
                console.log(apiURL);
                counter++;
            }

        }
    });

    // We define the function
    function drawTable(tableId, apiURL) {

        var l = jQuery("#tableId tr").length;
        console.log(tableId + " " + l);

        var dataTable = $('#' + tableId).DataTable({
            iDisplayLength: 10,
            serverSide: true,
            ajax: {
                url: apiURL, // json datasource
                type: "post",  // method  , by default get

                error: function () {  // error handling
                    $(".pdxFinder-grid-error").html("");
                    $("#" + tableId).append('<tbody class="pdxFinder-grid-error"><tr><th colspan="3">No data found in the server</th></tr></tbody>');
                    $("#pdxFinder-grid_processing").css("display", "none");
                }
            },

            dom: "frtiS",
            scrollY: 350,
            scrollX: true,
            deferRender: true,
            responsive: true,
            bAutoWidth: true,
            scrollCollapse: true,
            scroller: {
                loadingIndicator: true,
                rowHeight: 30
            }

        });

        $(window).bind('resize', function () {
            dataTable.fnAdjustColumnSizing();
        });
    }


    function showTabs(cnt) {
        for (var i = 0; i < 5; i++) {
            var content = document.getElementsByClassName("hideContent"+cnt)[i];
            var variation = document.getElementsByClassName("hideVariationData")[0];

            if(content !== undefined){
                content.style.position = "static";
            }
            if (variation !== undefined){
                variation.style.position = "static";
            }

        }
    }


    function initTabs(cnt) {
        for (var i = 0; i < 5; i++) {
            document.getElementsByClassName("hideContent"+cnt)[i].style.position = "static";
        }
    }

    function revealVariationData() {

        // Activate the display of the vData
        document.getElementsByClassName("hideVariationData")[0].style.position = "static";

        // Open the corresponding tech Tab:
        // showTabs(cnt);
    }


    // Check if variation tab is deeplinked on page load:
    $(document).ready(function(){
        var hash = window.location.hash;

        if (hash == "#variation"){
            for (var i = 0; i < 5; i++) {
                var content = document.getElementsByClassName("hideContent0")[i];
                if (content !== undefined){
                    content.style.position = "static";
                }

            }
        }
    });





</script>

<script type="application/ld+json">

{
    "@context": "http://schema.org",
    "@type": "Dataset",
    "@id": "http://www.pdxfinder.org/",
    "url": "http://www.pdxfinder.org",
    "name": "PDX  Finder:  An  Open  and  Global  Catalogue  of  Patient  Tumor  Derived Xenograft  Models",
    "description": "PDX  Finder is  a  comprehensive  open  global  catalogue  of  PDX  models  and  their  associated  data  across  resources.  PDX  Finder allows  is using  multiple  search  and  filtering  attributes  (e.g:  tumor  histology,  molecular variant, drug-response). Critical PDX attributes are  harmonized against ontological terms and integrated  into  a  cohesive  data  model  which  supports  consistent  searching  across  sources. Additionally,  specific pages and links to the PDX providers are  provided  to  allow  users  to  contact  the  relevant  institution  for  further  collaboration/model  acquisition.This dataset contains all the PDX  metadata and data from different providers",
    "keywords": "PDX, Patient derived xenografts, cancer models, cancer, omic, drug response, oncology, preclinical",
    "creator": {"@type": "Organization","name": "PDX Finder"},
    "dateCreated": "2018",
    "dateModified": "2018",
    "citation": "https://doi.org/10.1101/291443",
}
</script>
</body>
</html>
